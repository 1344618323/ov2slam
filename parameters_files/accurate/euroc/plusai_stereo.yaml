%YAML 1.0
---

#--------------------------------------------------------------------------------------------
# Camera Parameters. Adjust them!
#--------------------------------------------------------------------------------------------

Camera.topic_left: /cam0/image_raw
Camera.topic_right: /cam1/image_raw

Camera.model_left: pinhole
Camera.model_right: pinhole

Camera.left_nwidth: 960
Camera.left_nheight: 540

Camera.right_nwidth: 960
Camera.right_nheight: 540

# 20231224T081132_pdb-l4e-b0002_22_101to194
# Camera calibration and distortion parameters (OpenCV) 
# Camera.fxl: 1.3214800000000000e+03
# Camera.fyl: 1.3214800000000000e+03
# Camera.cxl: 480
# Camera.cyl: 270

# Camera.k1l: -6.4034021827585019e-01
# Camera.k2l: 4.8455199272337723e-01
# Camera.p1l: 0.0
# Camera.p2l: 0.0

# Camera.fxr: 1.3214800000000000e+03
# Camera.fyr: 1.3214800000000000e+03
# Camera.cxr: 480
# Camera.cyr: 270

# Camera.k1r: -6.5368575545101193e-01
# Camera.k2r: 6.3363189046537594e-01
# Camera.p1r: 0.0
# Camera.p2r: 0.0

# # Camera Extrinsic parameters T_b_ci ( v_b = T_b_ci * v_ci )
# body_T_cam0: !!opencv-matrix
#    rows: 4
#    cols: 4
#    dt: d
#    data: [-2.7737148907138348e-03, -1.3001858713849823e-01,
#        9.9150767697694353e-01, 5.1100000000000003e+00,
#        -9.9998417017842200e-01, 5.2145925085985093e-03,
#        -2.1136266329473460e-03, 6.0000140987774808e-01,
#        -4.8954977560285743e-03, -9.9149784418498843e-01,
#        -1.3003099276035271e-01, 1.9815665645599365e+00, 0., 0., 0., 1.]

# body_T_cam1: !!opencv-matrix
#    rows: 4
#    cols: 4
#    dt: d
#    data: [-2.8907449926370756e-03, -1.3375401753739433e-01,
#        9.9101034625577711e-01, 5.1058724444217551e+00,
#        -9.9986939346365222e-01, -1.5371517371248490e-02,
#        -4.9912391582832187e-03, -6.0202249175517453e-01,
#        1.5900931042467183e-02, -9.9089534222657116e-01,
#        -1.3369211325157160e-01, 1.9873827957019043e+00, 0., 0., 0., 1.]

# 20240313T080709_pdb-l4e-c0001_24_1314to1344
Camera.fxl: 1.3201821710127344e+03
Camera.fyl: 1.3201821710127344e+03
Camera.cxl: 480
Camera.cyl: 270

Camera.k1l: -6.2441599999999997e-01
Camera.k2l: 3.0044599999999999e-01
Camera.p1l: 0.0
Camera.p2l: 0.0

Camera.fxr: 1.3081538836363550e+03
Camera.fyr: 1.3081538836363550e+03
Camera.cxr: 480
Camera.cyr: 270

Camera.k1r: -6.3421087861608749e-01
Camera.k2r: 3.4624472149105684e-01
Camera.p1r: 0.0
Camera.p2r: 0.0

# Camera Extrinsic parameters T_b_ci ( v_b = T_b_ci * v_ci )
body_T_cam0: !!opencv-matrix
   rows: 4
   cols: 4
   dt: d
   data: [-4.4127734833900633e-03, -1.3131971185080496e-01,
       9.9133024805541348e-01, 5.1100000000000003e+00,
       -9.9998129431453842e-01, -3.6192583529062604e-03,
       -4.9307190142152454e-03, 6.0000140987774797e-01,
       4.2353808809263175e-03, -9.9133346268972389e-01,
       -1.3130128445829170e-01, 1.9881204528808594e+00, 0., 0., 0., 1.]

body_T_cam1: !!opencv-matrix
   rows: 4
   cols: 4
   dt: d
   data: [1.1199195490820395e-02, -1.4203287527916642e-01,
       9.8979858575383539e-01, 5.1151811717302031e+00,
       -9.9987148800110759e-01, 9.7648264789299052e-03,
       1.2714387373712891e-02, -6.0202448053117319e-01,
       -1.1471072435078901e-02, -9.8981377566882289e-01,
       -1.4190526414978513e-01, 1.9837341557261150e+00, 0., 0., 0., 1. ]

# 20240220T112329_pdb-l4e-b0001_0_0to59
# Camera.fxl: 1.3214800000000000e+03
# Camera.fyl: 1.3214800000000000e+03
# Camera.cxl: 480
# Camera.cyl: 270

# Camera.k1l: -6.2441600000000008e-01
# Camera.k2l: 3.0044600000000005e-01
# Camera.p1l: 0.0
# Camera.p2l: 0.0

# Camera.fxr: 1.3214800000000000e+03
# Camera.fyr: 1.3214800000000000e+03
# Camera.cxr: 480
# Camera.cyr: 270

# Camera.k1r: -5.4184528072624105e-01
# Camera.k2r: -1.7428619505438445e-01
# Camera.p1r: 0.0
# Camera.p2r: 0.0

# # Camera Extrinsic parameters T_b_ci ( v_b = T_b_ci * v_ci )
# body_T_cam0: !!opencv-matrix
#    rows: 4
#    cols: 4
#    dt: d
#    data: [1.0434698112282840e-03, -1.2267298798514477e-01,
#        9.9244659765125476e-01, 5.1100000000000030e+00,
#        -9.9999598644991039e-01, -2.7421686653797761e-03,
#        7.1245707440881927e-04, 6.0000140987774808e-01,
#        2.6340567240123471e-03, -9.9244335784457194e-01,
#        -1.2267535700118315e-01, 1.9930346174240112e+00, 0., 0., 0., 1.]

# body_T_cam1: !!opencv-matrix
#    rows: 4
#    cols: 4
#    dt: d
#    data: [6.8531068968547349e-03, -1.2466742659064420e-01,
#        9.9217491788148360e-01, 5.1182237282762291e+00,
#        -9.9987363614280134e-01, 1.3378007375321117e-02,
#        8.5872385107443015e-03, -5.9984695349361383e-01,
#        -1.4343872295682481e-02, -9.9210839209530644e-01,
#        -1.2455999221914386e-01, 1.9758219706691922e+00, 0., 0., 0., 1.  ]

#--------------------------------------------------------------------------------------------
# SLAM Parameters. Adjust them!
#--------------------------------------------------------------------------------------------
debug: 0
log_timings: 0

mono: 0
stereo: 1

force_realtime: 1

# Estimator Mode
slam_mode: 1

# Loop Closing mode
buse_loop_closer: 1

# Stereo rectify or not
bdo_stereo_rect: 0
alpha: 0.

# Undist Image or not
bdo_undist: 0

# Init / KF px th.
finit_parallax: 20.

# Features Extractor
use_shi_tomasi: 0
use_fast: 0
use_brief: 1
use_singlescale_detector: 1

# Min dist between kps (define the number of kps)
nmaxdist: 35

# Features quality th.
nfast_th: 10
dmaxquality: 0.001 # used for gftt or singlescale

# Pre-processing
use_clahe: 1
fclahe_val: 3

# KLT related settings.
do_klt: 1
klt_use_prior: 1
btrack_keyframetoframe: 0
nklt_win_size: 9
nklt_pyr_lvl: 3

# Opencv Default: 30 iters. + 0.01 prec.
nmax_iter: 30
fmax_px_precision: 0.01

fmax_fbklt_dist: 0.5
nklt_err: 30.

# Matching th.
bdo_track_localmap: 1

fmax_desc_dist: 0.2 #0.35 # Ratio from desc size (for binary desc.) 
fmax_proj_pxdist: 2.

# Randomize RANSAC?
doepipolar: 1
dop3p : 0
bdo_random: 1
nransac_iter: 100
fransac_err: 3.

# Reproj err th.
fmax_reproj_err: 3.
buse_inv_depth: 1

# Ceres related parameters
robust_mono_th: 5.9915 # (20% : 3.2189 / 10% :  4.6052 / 5% : 5.9915 / 2%: 7.8240 / 1%: 9.2103)  

use_sparse_schur: 1
use_dogleg: 0
use_subspace_dogleg: 0
use_nonmonotic_step: 0

# Estimator parameters
apply_l2_after_robust: 1

nmin_covscore: 25 # Min co-obs for optimizing in SLAM mode BA

# Map Filtering
fkf_filtering_ratio: 0.95

# Final Pass
do_full_ba: 0